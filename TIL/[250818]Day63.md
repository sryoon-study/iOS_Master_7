
내일배움캠프 iOS 마스터 Day 63

#내일배움캠프 #iOS #TIL #MapKit
## 내일배움캠프 iOS 마스터 부트캠프 7기

## Day 63

### 주요 활동
- 최종과제 계획

### 주요 학습

# 구현 난이도 가늠

- **가장 쉬움 (권장)**:
    
    **MapKit(MKMapView + MKLocalSearch/Completer)** 로 장소 검색·선택 → 저장은 좌표/이름/주소만 → 상세에서 **Apple 지도 or Google 지도**로 **딥링크** 열기.
    
    → 별도 키/과금 없음, 심사 리스크 낮음, 해외 장소도 무난.
    
- **중간 난이도**:
    
    MapKit + **Core Spotlight** 인덱싱, **Map Snapshot/Look Around 프리뷰**, 클러스터링까지.
    
    → UX 고급화, 성능·메모리 고려 필요.
    
- **높은 난이도 (비권장, 초반엔 생략)**:
    
    **Google Places SDK/Maps SDK** 도입(자동완성·리치 POI 데이터) + 길찾기.
    
    → API 키·과금·TOS 제약(타 지도와 데이터 혼용 금지 영역)·심사 주의.
    

# 설계 포인트

## 1) 장소 입력(검색/선택)

- **자동완성**: MapKit의 **MKLocalSearchCompleter** 사용(딥링크/키 불필요, 디바이스/지역 최적화).
    
    검색 결과 선택 시 **MKMapItem**을 얻고, 위치 고정은 MKCoordinateRegion으로.
    
- **터치 선택**: 맵에서 롱탭으로 좌표 찍고 **Reverse Geocoding(CLGeocoder)** 로 주소를 채우는 옵션도 제공(해외 공연장 주소가 애매할 때 유용).
- **데이터 저장 스키마**(락인 최소화):
    - 필수: `latitude/longitude`, `displayName`, `formattedAddress`
    - 선택: `countryCode`, `timeZoneIdentifier`, `boundingRegion(zoom 힌트)`, `phone/url`
    - (선택) **provider 식별자**: `provider = apple | google | manual` + `providerPlaceId` (훗날 마이그레이션 대비)
        
        → 특정 사업자 ID에 의존하지 않고 **좌표 + 휴먼리더블 주소**를 정본으로.
        

## 2) 상세에서 길찾기 연결(딥링크)

- **Apple 지도**: 시스템 기본. 운전/대중교통/도보 모드 지정 가능. 앱 미설치 이슈 없음.
- **Google 지도**: 딥링크 스킴(`comgooglemaps://…`) + **미설치 시** 웹 링크(`https://www.google.com/maps/dir/?api=1…`)로 폴백.
- **앱 선택 UX**: 두 앱이 모두 가능한 경우 **최초 1회 선택 + 환경설정 저장**(“항상 이 앱으로 열기” 토글).
- **iOS 설정 주의**: `canOpenURL` 사용 시 Info.plist의 **LSApplicationQueriesSchemes**에 `comgooglemaps` 등 허용 스킴 등록 필요.

## 3) 해외 공연장 대응

- **주소 현지화**: CLGeocoder/LocalSearch의 **locale**를 사용자 언어(ko) + 백업(en)로 시도. 저장은 “표시용 주소”와 “원문 주소”를 함께(현지 검색 정확도↑).
- **좌표 우선 전략**: 국가/행정구역 포맷이 제각각이므로 **길찾기 전달은 좌표를 정본**으로. 앱들은 좌표 기반 길찾기가 가장 안정적.
- **교통수단 가용성 차이**: 국가별로 대중교통 길찾기가 지원되지 않을 수 있음 → **가능 모드 탐지 or 기본 모드(자동차)** 폴백.

## 4) 지도 UI/UX 보강 아이디어

- **미디어가 많은 일지**: 상세 카드에서 **Map Snapshot(정적 미니맵)** 을 먼저 보여주고 “지도로 보기” 탭 시 풀맵 전환(성능/배터리 이점).
- **Look Around/Street View 프리뷰**: MapKit의 Look Around(가용 지역 한정)를 제공하면 장소 회고 UX가 좋아짐.
- **클러스터링**: 다건 이벤트 지도 보기 시 MKMapView **클러스터** 활성화(줌/패닝 성능 개선).
- **오프라인 퍼스트**: 좌표/주소를 로컬에 **영구 캐시**. 재실행 시 재지오코딩에 의존하지 않도록.

## 5) 권한/프라이버시

- **위치 권한은 “앱 사용 중”만** 요청(현재 위치로 지도 초점/근처 검색용). 권한 거부 시에도 **수동 검색/핀 찍기**로 완전 대응.
- **백그라운드 위치는 불필요**(배터리/심사 리스크↑).
- **개인정보**: 사용자의 “즐겨찾는 장소” 등 민감도 고려. iCloud 동기화 시 최소필드만 전송.

## 6) 성능/품질/심사 관점

- **자동완성 디바운스**(300~500ms) + in-flight 검색 취소로 네트워크 낭비 방지.
- **지도 오버레이/어노테이션 재사용**(대량 표시 시 CPU 스파이크 예방).
- **외부 지도 데이터 혼용 주의**: Google Places에서 받은 데이터(특히 사진/리뷰/풍부한 POI 필드)를 Apple 지도에 렌더링하는 건 **TOS 이슈**가 있을 수 있음. 초반엔 MapKit 단일 스택을 권장.
- **테스트**: 해외 케이스(도시/시골), 지하 공연장(주소가 모호), 동일 좌표에 복수 POI, 언어/스크립트(라틴/비라틴) 등 엣지 시나리오를 포함.

## 7) 선택지 요약(추천 우선순위)

1. **MapKit만으로 구현 + Apple/Google 딥링크 옵션**
    - 장점: 간단/안정/무과금, 심사 리스크↓, 해외도 좌표 기반으로 OK
    - 단점: POI 메타가 구글 대비 심플
2. (필요 시 확장) **Map Snapshot/Look Around, Spotlight 인덱스, 클러스터링**
3. (정말 필요할 때) **Google Places/Maps** 도입
    - 장점: 풍부한 POI/리뷰/사진
    - 단점: 키/과금/TOS, 데이터 혼용 제약, 심사 고려 증가


### 8/18 예상일정
- RxFlow 학습
- 와이어프레임

velog 주소    
